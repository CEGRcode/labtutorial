"use strict";(self.webpackChunklabtutorial=self.webpackChunklabtutorial||[]).push([[972],{5680:(e,t,n)=>{n.d(t,{xA:()=>p,yg:()=>g});var o=n(6540);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var i=o.createContext({}),c=function(e){var t=o.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=c(e.components);return o.createElement(i.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,i=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=c(n),m=r,g=d["".concat(i,".").concat(m)]||d[m]||u[m]||a;return n?o.createElement(g,l(l({ref:t},p),{},{components:n})):o.createElement(g,l({ref:t},p))}));function g(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,l=new Array(a);l[0]=m;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s[d]="string"==typeof e?e:r,l[1]=s;for(var c=2;c<a;c++)l[c]=n[c];return o.createElement.apply(null,l)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},1067:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>l,default:()=>u,frontMatter:()=>a,metadata:()=>s,toc:()=>c});var o=n(8168),r=(n(6540),n(5680));const a={id:"cac",title:"Cornell's CAC server setup",sidebar_position:800},l=void 0,s={unversionedId:"Software/cac",id:"Software/cac",title:"Cornell's CAC server setup",description:"Instructions to manually setup Cornell's CAC VM hosting servers.",source:"@site/docs/Software/CAC.md",sourceDirName:"Software",slug:"/Software/cac",permalink:"/labtutorial/Software/cac",draft:!1,tags:[],version:"current",lastUpdatedBy:"Olivia Wen-Mei Lang",lastUpdatedAt:1725565575,formattedLastUpdatedAt:"Sep 5, 2024",sidebarPosition:800,frontMatter:{id:"cac",title:"Cornell's CAC server setup",sidebar_position:800},sidebar:"softwareSidebar",previous:{title:"Galaxy Resources",permalink:"/labtutorial/Software/galaxy"},next:{title:"PSU Archive",permalink:"/labtutorial/Software/PSU_Archive/"}},i={},c=[{value:"Enable the EPEL repository",id:"enable-the-epel-repository",level:3},{value:"Install nodejs",id:"install-nodejs",level:3},{value:"Install mongodb",id:"install-mongodb",level:3},{value:"Install apache",id:"install-apache",level:3},{value:"Requesting SSL certificates for the VMs",id:"requesting-ssl-certificates-for-the-vms",level:3},{value:"Useful commands",id:"useful-commands",level:3}],p={toc:c},d="wrapper";function u(e){let{components:t,...n}=e;return(0,r.yg)(d,(0,o.A)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.yg)("p",null,"Instructions to manually setup Cornell's CAC VM hosting servers."),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Server Names"),(0,r.yg)("th",{parentName:"tr",align:null},"Category"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("a",{parentName:"td",href:"http://odin.cac.cornell.edu/"},"odin.cac.cornell.edu")),(0,r.yg)("td",{parentName:"tr",align:null},"Web Production Server")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},(0,r.yg)("a",{parentName:"td",href:"http://artemis.cac.cornell.edu/"},"artemis.cac.cornell.edu")),(0,r.yg)("td",{parentName:"tr",align:null},"Web Development Server")))),(0,r.yg)("h3",{id:"enable-the-epel-repository"},"Enable the EPEL repository"),(0,r.yg)("p",null,"EPEL repository consists of packages for tools such as ",(0,r.yg)("inlineCode",{parentName:"p"},"htop")," and more."),(0,r.yg)("p",null,"To add the EPEL repository for tool lookup, run:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"dnf install https://dl.fedoraproject.org/pub/epel/epel-release-latest-8.noarch.rpm\ndnf update\ndnf install htop\n")),(0,r.yg)("h3",{id:"install-nodejs"},"Install nodejs"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"# checking available nodejs versions\n$ sudo dnf module list nodejs\n\n# disable defaults\n$ sudo dnf module disable nodejs:10\n\n# pick the Latest LTS version\n$ sudo dnf module enable nodejs:12\n\n# install and verify version\n$ sudo dnf install nodejs\n$ node --version\n")),(0,r.yg)("blockquote",null,(0,r.yg)("p",{parentName:"blockquote"},"reference : ",(0,r.yg)("a",{parentName:"p",href:"https://www.digitalocean.com/community/tutorials/how-to-install-node-js-on-centos-8"},"https://www.digitalocean.com/community/tutorials/how-to-install-node-js-on-centos-8"))),(0,r.yg)("h3",{id:"install-mongodb"},"Install mongodb"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"$ sudo nano /etc/yum.repos.d/mongodb-org-4.2.repo\n\n# copy below text into the file\n\n[mongodb-org-4.2]\nname=MongoDB Repository\nbaseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/4.2/x86_64/\ngpgcheck=1\nenabled=1\ngpgkey=https://www.mongodb.org/static/pgp/server-4.2.asc\n\n")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"# Install and start the mongod service.\n$ sudo yum install -y mongodb-org\n$ sudo service mongod start\n\n# Checking installation by bringing up the mongodb prompt.\n$ mongo\n\n# You can verify that the mongod process has started successfully\n# by checking the contents of the log file at `/var/log/mongodb/mongod.log`\n$ sudo less /var/log/mongodb/mongod.log\n\n")),(0,r.yg)("blockquote",null,(0,r.yg)("p",{parentName:"blockquote"},"reference: ",(0,r.yg)("a",{parentName:"p",href:"https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/"},"https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/\n"))),(0,r.yg)("h3",{id:"install-apache"},"Install apache"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"$ sudo yum install httpd\n$ sudo systemctl start httpd\n\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"CentOS 8 has lot of firewall restrictions built in, so to open up ports use the ",(0,r.yg)("inlineCode",{parentName:"li"},"firewall-cmd")," command.")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"sudo firewall-cmd --zone=public --permanent --add-port 8081/tcp\nsudo firewall-cmd --reload\n\nsudo firewall-cmd --zone=public --permanent --add-port 3000/tcp\nsudo firewall-cmd --reload\n")),(0,r.yg)("blockquote",null,(0,r.yg)("p",{parentName:"blockquote"},"Apache reference :",(0,r.yg)("a",{parentName:"p",href:"https://linuxize.com/post/how-to-install-apache-on-centos-8/"},"https://linuxize.com/post/how-to-install-apache-on-centos-8/\n"))),(0,r.yg)("blockquote",null,(0,r.yg)("p",{parentName:"blockquote"},"Firewall reference: ",(0,r.yg)("a",{parentName:"p",href:"https://linuxconfig.org/redhat-8-open-and-close-ports"},"https://linuxconfig.org/redhat-8-open-and-close-ports\n"))),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Apache needs to read the ",(0,r.yg)("inlineCode",{parentName:"li"},".htaccess")," files within the frontend deployment folders available at ",(0,r.yg)("inlineCode",{parentName:"li"},"/var/www/html/<project-folder>"),".\nThis is required for resolving routes on the client's side. you can read more ",(0,r.yg)("a",{parentName:"li",href:"https://create-react-app.dev/docs/deployment/#serving-apps-with-client-side-routing"},"here"),". Below are the steps to enable this.")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"# stop the apache server\n$ sudo service httpd stop\n\n# check the status of your apache server (to check if it is stopped)\n$ sudo service httpd status\n\n# edit the httpd (apache's) configuration (usually located at below default install location)\n$ cd /etc/httpd/conf/\n$ sudo nano httpd.conf\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Look for the lines below within the configuration file.")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},'# Further relax access to the default document root:\n<Directory "/var/www/html">\n    #\n    # Possible values for the Options directive are "None", "All",\n    # or any combination of:\n    #   Indexes Includes FollowSymLinks SymLinksifOwnerMatch ExecCGI MultiViews\n    #\n    # Note that "MultiViews" must be named *explicitly* --- "Options All"\n    # doesn\'t give it to you.\n    #\n    # The Options directive is both complicated and important.  Please see\n    # http://httpd.apache.org/docs/2.4/mod/core.html#options\n    # for more information.\n    #\n    Options Indexes MultiViews FollowSymLinks\n\n    #\n    # AllowOverride controls what directives may be placed in .htaccess files.\n    # It can be "All", "None", or any combination of the keywords:\n    #   Options FileInfo AuthConfig Limit\n    #\n    AllowOverride None\n\n    #\n    # Controls who can get stuff from this server.\n    #\n    Require all granted\n\n</Directory>\n\n')),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Now add these directives into ",(0,r.yg)("inlineCode",{parentName:"li"},"httpd.conf")," ",(0,r.yg)("strong",{parentName:"li"},"AFTER")," the above directives, to allow apache to read ",(0,r.yg)("inlineCode",{parentName:"li"},".htaccess")," in our website's folder. These lines needs to be added for each website you are deploying (for those that are built on react).")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"<Directory /var/www/html/yep>\n    Options Indexes FollowSymLinks\n    AllowOverride All\n    Require all granted\n</Directory>\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"start the server, your websites now route correctly on the client.")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"sudo service httpd start\n")),(0,r.yg)("h3",{id:"requesting-ssl-certificates-for-the-vms"},"Requesting SSL certificates for the VMs"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Generate a ",(0,r.yg)("strong",{parentName:"li"},"key")," and ",(0,r.yg)("strong",{parentName:"li"},"csr")," file for your server.")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"openssl req -nodes -newkey rsa:2048 -keyout artemis_ssl.key -out artemis_ssl.csr\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"you will be prompted with a questionnaire. below are ",(0,r.yg)("strong",{parentName:"li"},"EXAMPLE")," answers.")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"Generating a RSA private key\n.............................................+++++......+++++\n\nwriting new private key to 'artemis_ssl.key'\n-----\nYou are about to be asked to enter information that will be incorporated\ninto your certificate request.\nWhat you are about to enter is what is called a Distinguished Name or a DN.\nThere are quite a few fields but you can leave some blank\nFor some fields there will be a default value,\nIf you enter '.', the field will be left blank.\n-----\n\nCountry Name (2 letter code) [XX]:US\nState or Province Name (full name) []:New York\nLocality Name (eg, city) [Default City]:Ithaca\nOrganization Name (eg, company) [Default Company Ltd]:Cornell University\nOrganizational Unit Name (eg, section) []:Center for Advanced Computing\nCommon Name (eg, your name or your server's hostname) []: artemis.cac.cornell.edu\nEmail Address []:cac-systems@cornell.edu\n\nPlease enter the following 'extra' attributes\nto be sent with your certificate request\nA challenge password []:\nAn optional company name []:\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"email the resulting ",(0,r.yg)("inlineCode",{parentName:"li"},"myserver.csr")," file to ",(0,r.yg)("inlineCode",{parentName:"li"},"cac-help@cornell.edu"),". After a couple of hours or the next day you should receive an ssl cert from them.")),(0,r.yg)("h3",{id:"useful-commands"},"Useful commands"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Exporting collections (tables in mongoDB) in a databases as JSON")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"mongoexport --collection=samples --db=yepDB --out=yepSamples-2020-01-01.json\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Change Ownership recursively for image assets being served by the API BACKEND. ",(0,r.yg)("em",{parentName:"li"},"Should be owned by root and set to public access."))),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"$ sudo chown -R user:group folder\n$ sudo chown -R root:root yepImages\n\n# have access to all for the images to show up on the website.\n$ sudo chmod -R 755 yepImages\n")))}u.isMDXComponent=!0}}]);